<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "https://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml" lang="en-US">
<head>
<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=11"/>
<meta name="generator" content="Doxygen 1.15.0"/>
<meta name="viewport" content="width=device-width, initial-scale=1"/>
<title>VisualNet Scanner: main Namespace Reference</title>
<link href="tabs.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="jquery.js"></script>
<script type="text/javascript" src="dynsections.js"></script>
<script type="text/javascript" src="clipboard.js"></script>
<link href="navtree.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="navtreedata.js"></script>
<script type="text/javascript" src="navtree.js"></script>
<script type="text/javascript" src="cookie.js"></script>
<link href="search/search.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="search/searchdata.js"></script>
<script type="text/javascript" src="search/search.js"></script>
<link href="doxygen.css" rel="stylesheet" type="text/css" />
</head>
<body>
<div id="top"><!-- do not remove this div, it is closed by doxygen! -->
<div id="titlearea">
<table cellspacing="0" cellpadding="0">
 <tbody>
 <tr id="projectrow">
  <td id="projectalign">
   <div id="projectname">VisualNet Scanner<span id="projectnumber">&#160;1.0</span>
   </div>
   <div id="projectbrief">Comprehensive vulnerability scanner for Linux machines with network visualization</div>
  </td>
 </tr>
 </tbody>
</table>
</div>
<!-- end header part -->
<!-- Generated by Doxygen 1.15.0 -->
<script type="text/javascript">
var searchBox = new SearchBox("searchBox", "search/",'.html');
</script>
<script type="text/javascript">
$(function() { codefold.init(); });
</script>
<script type="text/javascript" src="menudata.js"></script>
<script type="text/javascript" src="menu.js"></script>
<script type="text/javascript">
$(function() {
  initMenu('',true,false,'search.php','Search',true);
  $(function() { init_search(); });
});
</script>
<div id="main-nav"></div>
</div><!-- top -->
<div id="side-nav" class="ui-resizable side-nav-resizable">
  <div id="nav-tree">
    <div id="nav-tree-contents">
      <div id="nav-sync" class="sync"></div>
    </div>
  </div>
  <div id="splitbar" style="-moz-user-select:none;" 
       class="ui-resizable-handle">
  </div>
</div>
<script type="text/javascript">
$(function(){initNavTree('namespacemain.html','',''); });
</script>
<div id="container">
<div id="doc-content">
<!-- window showing the filter options -->
<div id="MSearchSelectWindow"
     onmouseover="return searchBox.OnSearchSelectShow()"
     onmouseout="return searchBox.OnSearchSelectHide()"
     onkeydown="return searchBox.OnSearchSelectKey(event)">
</div>

<!-- iframe showing the search results (closed by default) -->
<div id="MSearchResultsWindow">
<div id="MSearchResults">
<div class="SRPage">
<div id="SRIndex">
<div id="SRResults"></div>
<div class="SRStatus" id="Loading">Loading...</div>
<div class="SRStatus" id="Searching">Searching...</div>
<div class="SRStatus" id="NoMatches">No Matches</div>
</div>
</div>
</div>
</div>

<div class="header">
  <div class="headertitle"><div class="title">main Namespace Reference</div></div>
</div><!--header-->
<div class="contents">
<table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 id="header-func-members" class="groupheader"><a id="func-members" name="func-members"></a>
Functions</h2></td></tr>
<tr class="memitem:a9dfd646f04b968f92a2ab94c1493d3af" id="r_a9dfd646f04b968f92a2ab94c1493d3af"><td class="memItemLeft" align="right" valign="top">&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="#a9dfd646f04b968f92a2ab94c1493d3af">flush_all_caches</a> ()</td></tr>
<tr class="memitem:aa5698a40df08aacb548acf0dad2f69c7" id="r_aa5698a40df08aacb548acf0dad2f69c7"><td class="memItemLeft" align="right" valign="top">&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="#aa5698a40df08aacb548acf0dad2f69c7">parse_arguments</a> ()</td></tr>
<tr class="memitem:a3140e9a5b6a71ffbf498198cfc471b88" id="r_a3140e9a5b6a71ffbf498198cfc471b88"><td class="memItemLeft" align="right" valign="top">&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="#a3140e9a5b6a71ffbf498198cfc471b88">main</a> ()</td></tr>
</table><table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 id="header-var-members" class="groupheader"><a id="var-members" name="var-members"></a>
Variables</h2></td></tr>
<tr class="memitem:afef337eddfc730fa16e4d7ecb5eb2097" id="r_afef337eddfc730fa16e4d7ecb5eb2097"><td class="memItemLeft" align="right" valign="top">str&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="#afef337eddfc730fa16e4d7ecb5eb2097">log_dir</a> = &quot;logs&quot;</td></tr>
<tr class="memitem:abd0f76b760bdf1aa416cde1239b72682" id="r_abd0f76b760bdf1aa416cde1239b72682"><td class="memItemLeft" align="right" valign="top">&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="#abd0f76b760bdf1aa416cde1239b72682">log_filename</a> = os.path.join(log_dir, f&quot;vulnerability_scan_{datetime.now().strftime('%Y%m%d_%H%M%S')}.log&quot;)</td></tr>
<tr class="memitem:ad39dcd94f0ffc845ab416c0783c20d25" id="r_ad39dcd94f0ffc845ab416c0783c20d25"><td class="memItemLeft" align="right" valign="top">&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="#ad39dcd94f0ffc845ab416c0783c20d25">level</a></td></tr>
<tr class="memitem:a758a4b3c52742d78aa30e49d058acea4" id="r_a758a4b3c52742d78aa30e49d058acea4"><td class="memItemLeft" align="right" valign="top">&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="#a758a4b3c52742d78aa30e49d058acea4">format</a></td></tr>
<tr class="memitem:abc8fd2c6474f154e4b0bc05a0a64aa82" id="r_abc8fd2c6474f154e4b0bc05a0a64aa82"><td class="memItemLeft" align="right" valign="top">&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="#abc8fd2c6474f154e4b0bc05a0a64aa82">handlers</a></td></tr>
<tr class="memitem:ae1d4a0295c904f672a1f044188274bf1" id="r_ae1d4a0295c904f672a1f044188274bf1"><td class="memItemLeft" align="right" valign="top">&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="#ae1d4a0295c904f672a1f044188274bf1">logger</a> = logging.getLogger(__name__)</td></tr>
</table>
<a name="details" id="details"></a><h2 id="header-details" class="groupheader">Detailed Description</h2>
<div class="textblock"><pre class="fragment">@file main.py
@brief Main orchestrator for vulnerability scanning across multiple machines

This script performs a comprehensive vulnerability assessment by:
1. Testing NVD API connectivity
2. Iterating through each machine in the inventory
3. Retrieving installed packages from each machine
4. Generating CPE (Common Platform Enumeration) identifiers using AI
5. Querying the NVD (National Vulnerability Database) for vulnerabilities
6. Generating JSON reports with vulnerability details and CVE links

@author Anton Moulin
@date 2025-12-24
@version 1.0

@details
The script uses:
- SSH to connect to remote Linux machines
- Google GenAI API to generate CPEs from package names
- NVD API to retrieve CVE data
- Local caching to optimize repeated runs
- Rate limiting to respect API quotas
</pre><pre class="fragment">@file main.py
@brief Vulnerability Scanner - Main entry point

This is the main entry point for the vulnerability scanner application.
It imports and runs the core application logic from src/core/main.py.

@author Anton Moulin
@date 2025-12-24
@version 1.0
</pre> </div><a name="doc-func-members" id="doc-func-members"></a><h2 id="header-doc-func-members" class="groupheader">Function Documentation</h2>
<a id="a9dfd646f04b968f92a2ab94c1493d3af" name="a9dfd646f04b968f92a2ab94c1493d3af"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a9dfd646f04b968f92a2ab94c1493d3af">&#9670;&#160;</a></span>flush_all_caches()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">main.flush_all_caches </td>
          <td>(</td>
          <td class="paramname"><span class="paramname"><em></em></span></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">
<pre class="fragment">Remove all cached data including package caches, CPE caches, and vulnerability database.

@details
Flushes:
- machines/cpe_cache.json (global CPE cache)
- machines/{machine}/installed_packages.json (per-machine package lists)
- machines/{machine}/vulnerability_report.json (generated reports)
- db/vulnerability_cache.db (SQLite vulnerability cache)
</pre> 
<p class="definition">Definition at line <a class="el" href="src_2core_2main_8py_source.html#l00063">63</a> of file <a class="el" href="src_2core_2main_8py_source.html">src/core/main.py</a>.</p>

</div>
</div>
<a id="a3140e9a5b6a71ffbf498198cfc471b88" name="a3140e9a5b6a71ffbf498198cfc471b88"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a3140e9a5b6a71ffbf498198cfc471b88">&#9670;&#160;</a></span>main()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">main.main </td>
          <td>(</td>
          <td class="paramname"><span class="paramname"><em></em></span></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">
<pre class="fragment">Main entry point for the vulnerability scanner application.

Orchestrates the complete vulnerability scanning workflow:
1. Parse command-line arguments
2. Load machine inventory from configuration file
3. Process each machine to discover packages and generate CPEs
4. Query NVD database for vulnerabilities
5. Generate JSON reports with CVE details

@return int Exit code (0 for success, 1 for errors)
</pre> 
<p class="definition">Definition at line <a class="el" href="src_2core_2main_8py_source.html#l00170">170</a> of file <a class="el" href="src_2core_2main_8py_source.html">src/core/main.py</a>.</p>

</div>
</div>
<a id="aa5698a40df08aacb548acf0dad2f69c7" name="aa5698a40df08aacb548acf0dad2f69c7"></a>
<h2 class="memtitle"><span class="permalink"><a href="#aa5698a40df08aacb548acf0dad2f69c7">&#9670;&#160;</a></span>parse_arguments()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">main.parse_arguments </td>
          <td>(</td>
          <td class="paramname"><span class="paramname"><em></em></span></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">
<pre class="fragment">Parse command-line arguments for inventory file, cache flushing, and forced checks.

@return argparse.Namespace Parsed arguments with attributes:
                           - inventory: Custom inventory file path
                           - flush_cache: Whether to flush all caches before scanning
                           - force_check: Whether to check all packages (not just new ones)
                           - report_only: Whether to only generate report from existing cache

@details
Supported arguments:
- --inventory FILE: Use custom inventory file (default: inventory.ini)
- --flush-cache: Remove all cached data before scanning
- --force-check: Check all packages even if no new ones detected (ignore cache)
- --report-only: Generate HTML report from existing cache data without scanning

Examples:
- python main.py --inventory custom_inventory.ini
- python main.py --flush-cache
- python main.py --force-check
- python main.py --report-only
- python main.py --inventory custom.ini --flush-cache --force-check
</pre> 
<p class="definition">Definition at line <a class="el" href="src_2core_2main_8py_source.html#l00119">119</a> of file <a class="el" href="src_2core_2main_8py_source.html">src/core/main.py</a>.</p>

</div>
</div>
<a name="doc-var-members" id="doc-var-members"></a><h2 id="header-doc-var-members" class="groupheader">Variable Documentation</h2>
<a id="a758a4b3c52742d78aa30e49d058acea4" name="a758a4b3c52742d78aa30e49d058acea4"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a758a4b3c52742d78aa30e49d058acea4">&#9670;&#160;</a></span>format</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">main.format</td>
        </tr>
      </table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="src_2core_2main_8py_source.html#l00054">54</a> of file <a class="el" href="src_2core_2main_8py_source.html">src/core/main.py</a>.</p>

</div>
</div>
<a id="abc8fd2c6474f154e4b0bc05a0a64aa82" name="abc8fd2c6474f154e4b0bc05a0a64aa82"></a>
<h2 class="memtitle"><span class="permalink"><a href="#abc8fd2c6474f154e4b0bc05a0a64aa82">&#9670;&#160;</a></span>handlers</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">main.handlers</td>
        </tr>
      </table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="src_2core_2main_8py_source.html#l00055">55</a> of file <a class="el" href="src_2core_2main_8py_source.html">src/core/main.py</a>.</p>

</div>
</div>
<a id="ad39dcd94f0ffc845ab416c0783c20d25" name="ad39dcd94f0ffc845ab416c0783c20d25"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ad39dcd94f0ffc845ab416c0783c20d25">&#9670;&#160;</a></span>level</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">main.level</td>
        </tr>
      </table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="src_2core_2main_8py_source.html#l00053">53</a> of file <a class="el" href="src_2core_2main_8py_source.html">src/core/main.py</a>.</p>

</div>
</div>
<a id="afef337eddfc730fa16e4d7ecb5eb2097" name="afef337eddfc730fa16e4d7ecb5eb2097"></a>
<h2 class="memtitle"><span class="permalink"><a href="#afef337eddfc730fa16e4d7ecb5eb2097">&#9670;&#160;</a></span>log_dir</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">str main.log_dir = &quot;logs&quot;</td>
        </tr>
      </table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="src_2core_2main_8py_source.html#l00047">47</a> of file <a class="el" href="src_2core_2main_8py_source.html">src/core/main.py</a>.</p>

</div>
</div>
<a id="abd0f76b760bdf1aa416cde1239b72682" name="abd0f76b760bdf1aa416cde1239b72682"></a>
<h2 class="memtitle"><span class="permalink"><a href="#abd0f76b760bdf1aa416cde1239b72682">&#9670;&#160;</a></span>log_filename</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">main.log_filename = os.path.join(log_dir, f&quot;vulnerability_scan_{datetime.now().strftime('%Y%m%d_%H%M%S')}.log&quot;)</td>
        </tr>
      </table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="src_2core_2main_8py_source.html#l00051">51</a> of file <a class="el" href="src_2core_2main_8py_source.html">src/core/main.py</a>.</p>

</div>
</div>
<a id="ae1d4a0295c904f672a1f044188274bf1" name="ae1d4a0295c904f672a1f044188274bf1"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ae1d4a0295c904f672a1f044188274bf1">&#9670;&#160;</a></span>logger</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">main.logger = logging.getLogger(__name__)</td>
        </tr>
      </table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="src_2core_2main_8py_source.html#l00060">60</a> of file <a class="el" href="src_2core_2main_8py_source.html">src/core/main.py</a>.</p>

</div>
</div>
</div><!-- contents -->
</div><!-- doc-content -->
<div id="page-nav" class="page-nav-panel">
<div id="page-nav-resize-handle"></div>
<div id="page-nav-tree">
<div id="page-nav-contents">
</div><!-- page-nav-contents -->
</div><!-- page-nav-tree -->
</div><!-- page-nav -->
</div><!-- container -->
<!-- start footer part -->
<div id="nav-path" class="navpath"><!-- id is needed for treeview function! -->
  <ul>
    <li class="navelem"><a href="namespacemain.html">main</a></li>
    <li class="footer">Generated on <span class="timestamp"></span> for VisualNet Scanner by <a href="https://www.doxygen.org/index.html"><img class="footer" src="doxygen.svg" width="104" height="31" alt="doxygen"/></a> 1.15.0 </li>
  </ul>
</div>
</body>
</html>
