<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "https://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml" lang="en-US">
<head>
<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=11"/>
<meta name="generator" content="Doxygen 1.15.0"/>
<meta name="viewport" content="width=device-width, initial-scale=1"/>
<title>VisualNet Scanner: src.reporting.report_generator Namespace Reference</title>
<link href="tabs.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="jquery.js"></script>
<script type="text/javascript" src="dynsections.js"></script>
<script type="text/javascript" src="clipboard.js"></script>
<link href="navtree.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="navtreedata.js"></script>
<script type="text/javascript" src="navtree.js"></script>
<script type="text/javascript" src="cookie.js"></script>
<link href="search/search.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="search/searchdata.js"></script>
<script type="text/javascript" src="search/search.js"></script>
<link href="doxygen.css" rel="stylesheet" type="text/css" />
</head>
<body>
<div id="top"><!-- do not remove this div, it is closed by doxygen! -->
<div id="titlearea">
<table cellspacing="0" cellpadding="0">
 <tbody>
 <tr id="projectrow">
  <td id="projectalign">
   <div id="projectname">VisualNet Scanner<span id="projectnumber">&#160;1.0</span>
   </div>
   <div id="projectbrief">Comprehensive vulnerability scanner for Linux machines with network visualization</div>
  </td>
 </tr>
 </tbody>
</table>
</div>
<!-- end header part -->
<!-- Generated by Doxygen 1.15.0 -->
<script type="text/javascript">
var searchBox = new SearchBox("searchBox", "search/",'.html');
</script>
<script type="text/javascript">
$(function() { codefold.init(); });
</script>
<script type="text/javascript" src="menudata.js"></script>
<script type="text/javascript" src="menu.js"></script>
<script type="text/javascript">
$(function() {
  initMenu('',true,false,'search.php','Search',true);
  $(function() { init_search(); });
});
</script>
<div id="main-nav"></div>
</div><!-- top -->
<div id="side-nav" class="ui-resizable side-nav-resizable">
  <div id="nav-tree">
    <div id="nav-tree-contents">
      <div id="nav-sync" class="sync"></div>
    </div>
  </div>
  <div id="splitbar" style="-moz-user-select:none;" 
       class="ui-resizable-handle">
  </div>
</div>
<script type="text/javascript">
$(function(){initNavTree('namespacesrc_1_1reporting_1_1report__generator.html','',''); });
</script>
<div id="container">
<div id="doc-content">
<!-- window showing the filter options -->
<div id="MSearchSelectWindow"
     onmouseover="return searchBox.OnSearchSelectShow()"
     onmouseout="return searchBox.OnSearchSelectHide()"
     onkeydown="return searchBox.OnSearchSelectKey(event)">
</div>

<!-- iframe showing the search results (closed by default) -->
<div id="MSearchResultsWindow">
<div id="MSearchResults">
<div class="SRPage">
<div id="SRIndex">
<div id="SRResults"></div>
<div class="SRStatus" id="Loading">Loading...</div>
<div class="SRStatus" id="Searching">Searching...</div>
<div class="SRStatus" id="NoMatches">No Matches</div>
</div>
</div>
</div>
</div>

<div class="header">
  <div class="headertitle"><div class="title">src.reporting.report_generator Namespace Reference</div></div>
</div><!--header-->
<div class="contents">
<table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 id="header-func-members" class="groupheader"><a id="func-members" name="func-members"></a>
Functions</h2></td></tr>
<tr class="memitem:a58e0139686486a07b55a0d9de5db76be" id="r_a58e0139686486a07b55a0d9de5db76be"><td class="memItemLeft" align="right" valign="top">&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="#a58e0139686486a07b55a0d9de5db76be">generate_cve_url</a> (cve_id)</td></tr>
<tr class="memitem:ad4c7201897714effc6c394d18d0b29b9" id="r_ad4c7201897714effc6c394d18d0b29b9"><td class="memItemLeft" align="right" valign="top">&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="#ad4c7201897714effc6c394d18d0b29b9">save_machine_report</a> (machine_name, vulnerabilities_data)</td></tr>
<tr class="memitem:a4c9609a081e0e44d7f519d11ad917668" id="r_a4c9609a081e0e44d7f519d11ad917668"><td class="memItemLeft" align="right" valign="top">&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="#a4c9609a081e0e44d7f519d11ad917668">get_total_vulnerabilities_from_report</a> (report_dict)</td></tr>
</table><table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 id="header-var-members" class="groupheader"><a id="var-members" name="var-members"></a>
Variables</h2></td></tr>
<tr class="memitem:ae28e1d52a9722cbc4b8a180fa5185f15" id="r_ae28e1d52a9722cbc4b8a180fa5185f15"><td class="memItemLeft" align="right" valign="top">&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="#ae28e1d52a9722cbc4b8a180fa5185f15">logger</a> = logging.getLogger(__name__)</td></tr>
</table>
<a name="details" id="details"></a><h2 id="header-details" class="groupheader">Detailed Description</h2>
<div class="textblock"><pre class="fragment">@file report_generator.py
@brief Vulnerability report generation and CVE URL management module

Generates structured JSON vulnerability reports for each scanned machine with
comprehensive CVE data including identifiers, descriptions, URLs, and publication dates.

Reports are designed for:
- Automated integration with vulnerability management systems
- Direct consumption by web dashboards and APIs
- Export to SIEM platforms
- Custom analysis tools

@author Anton Moulin
@date 2025-12-24
@version 1.0

@details
**Features:**

- Per-Machine JSON Reports:
  * Machine identification and scan timestamp
  * CPE to vulnerability mappings
  * CVE identifiers with descriptions
  * Direct URLs to CVE.org for detailed information
  * Publication dates for CVE tracking
  
- Report Structure:
  * Organized by affected components (CPEs)
  * Groups vulnerabilities per component
  * Includes complete CVE metadata
  
- CVE URL Generation:
  * Generates official CVE.org links
  * Format: https://cve.mitre.org/cgi-bin/cvename.cgi?name=CVE-XXXX-XXXXX
  * Clickable in modern terminals
  
- Persistence:
  * Saves to: cache/machines/{machine}/vulnerability_report.json
  * Uses JSON format for interoperability
  * Includes ISO 8601 timestamps
  
- Integration:
  * Reports are read by html_report_generator.py for dashboards
  * Used for severity estimation and statistics
  * Consumed by external tools via JSON import

**Report Format:**

```json
{
  "machine": "srv01",
  "timestamp": "2026-01-06T12:00:00.000000",
  "cpes_with_vulnerabilities": [
    {
      "cpe": "cpe:2.3:a:vendor:product:version:*:*:*:*:*:*:*",
      "vulnerabilities": [
        {
          "cve_id": "CVE-2024-1234",
          "description": "Vulnerability description from NVD",
          "cve_url": "https://cve.mitre.org/cgi-bin/cvename.cgi?name=CVE-2024-1234",
          "published_date": "2024-05-15T00:00:00Z"
        }
      ]
    }
  ]
}
```
</pre> </div><a name="doc-func-members" id="doc-func-members"></a><h2 id="header-doc-func-members" class="groupheader">Function Documentation</h2>
<a id="a58e0139686486a07b55a0d9de5db76be" name="a58e0139686486a07b55a0d9de5db76be"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a58e0139686486a07b55a0d9de5db76be">&#9670;&#160;</a></span>generate_cve_url()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">src.reporting.report_generator.generate_cve_url </td>
          <td>(</td>
          <td class="paramtype"></td>          <td class="paramname"><span class="paramname"><em>cve_id</em></span></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">
<pre class="fragment">Generate a direct link to CVE details on cve.mitre.org.

@param cve_id str CVE identifier (e.g., "CVE-2024-1234")

@return str Full URL to CVE details page

@details
Format: https://cve.mitre.org/cgi-bin/cvename.cgi?name=CVE-XXXX-XXXXX

These URLs are included in:
- Terminal output (clickable in modern terminals)
- JSON reports for reference
</pre> 
<p class="definition">Definition at line <a class="el" href="report__generator_8py_source.html#l00080">80</a> of file <a class="el" href="report__generator_8py_source.html">report_generator.py</a>.</p>

</div>
</div>
<a id="a4c9609a081e0e44d7f519d11ad917668" name="a4c9609a081e0e44d7f519d11ad917668"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a4c9609a081e0e44d7f519d11ad917668">&#9670;&#160;</a></span>get_total_vulnerabilities_from_report()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">src.reporting.report_generator.get_total_vulnerabilities_from_report </td>
          <td>(</td>
          <td class="paramtype"></td>          <td class="paramname"><span class="paramname"><em>report_dict</em></span></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">
<pre class="fragment">Count total vulnerabilities in a report structure.

@param report_dict dict Report dictionary (as generated by save_machine_report)

@return int Total number of vulnerabilities across all CPEs

@details
Useful for statistics and summary generation.
</pre> 
<p class="definition">Definition at line <a class="el" href="report__generator_8py_source.html#l00220">220</a> of file <a class="el" href="report__generator_8py_source.html">report_generator.py</a>.</p>

</div>
</div>
<a id="ad4c7201897714effc6c394d18d0b29b9" name="ad4c7201897714effc6c394d18d0b29b9"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ad4c7201897714effc6c394d18d0b29b9">&#9670;&#160;</a></span>save_machine_report()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">src.reporting.report_generator.save_machine_report </td>
          <td>(</td>
          <td class="paramtype"></td>          <td class="paramname"><span class="paramname"><em>machine_name</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"></td>          <td class="paramname"><span class="paramname"><em>vulnerabilities_data</em></span>&#160;)</td>
        </tr>
      </table>
</div><div class="memdoc">
<pre class="fragment">Generate and save JSON vulnerability report for a machine.

Creates a timestamped JSON file containing all vulnerabilities found
on a machine, organized by CPE (Common Platform Enumeration) with
clickable CVE references and publication dates.

@param machine_name str Name of the machine being reported
                       Format: hostname or identifier (e.g., "srv01")
@param vulnerabilities_data dict Vulnerability data structure
                                Format: {cpe: [{cve_id, description, published_date}, ...], ...}

@return str Path to generated report file, or None on failure
        Example: "cache/machines/srv01/vulnerability_report.json"

@details
**Output File Location:**

- Directory: cache/machines/{machine_name}/
- Filename: vulnerability_report.json
- Permissions: User readable
- Format: JSON with 2-space indentation

**Report Structure:**

```json
{
    "machine": "srv01",
    "timestamp": "2025-12-24T14:30:45.123456",
    "cpes_with_vulnerabilities": [
        {
            "cpe": "cpe:2.3:a:vendor:product:version:*:*:*:*:*:*:*",
            "vulnerabilities": [
                {
                    "cve_id": "CVE-2024-1234",
                    "description": "Vulnerability description from NVD",
                    "cve_url": "https://cve.mitre.org/cgi-bin/cvename.cgi?name=CVE-2024-1234",
                    "published_date": "2024-05-15T00:00:00Z"
                }
            ]
        }
    ]
}
```

**Data Processing:**

1. Creates machine directory if it doesn't exist
2. Iterates through vulnerabilities_data dictionary
3. For each CPE with vulnerabilities:
   - Creates CPE entry with empty vulnerabilities list
   - For each vulnerability:
     - Extracts cve_id, description, published_date
     - Generates CVE URL using generate_cve_url()
     - Appends to vulnerabilities list
   - Appends CPE entry to report
4. Writes report as formatted JSON
5. Logs success or failure

**Error Handling:**

- Missing machine name: Returns None
- Empty vulnerabilities_data: Creates empty report
- File write failure: Logs error, returns None
- Invalid UTF-8: Logs and skips problematic entries

**Timestamp Format:**

- ISO 8601 format with microseconds
- Timezone: Local system timezone
- Example: "2025-12-24T14:30:45.123456"

@note
- Report is human-readable (not minified)
- Directory is created automatically if missing
- Overwrites existing report without warning
- Logs generation details to logger for audit trail
</pre> 
<p class="definition">Definition at line <a class="el" href="report__generator_8py_source.html#l00098">98</a> of file <a class="el" href="report__generator_8py_source.html">report_generator.py</a>.</p>

</div>
</div>
<a name="doc-var-members" id="doc-var-members"></a><h2 id="header-doc-var-members" class="groupheader">Variable Documentation</h2>
<a id="ae28e1d52a9722cbc4b8a180fa5185f15" name="ae28e1d52a9722cbc4b8a180fa5185f15"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ae28e1d52a9722cbc4b8a180fa5185f15">&#9670;&#160;</a></span>logger</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">src.reporting.report_generator.logger = logging.getLogger(__name__)</td>
        </tr>
      </table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="report__generator_8py_source.html#l00077">77</a> of file <a class="el" href="report__generator_8py_source.html">report_generator.py</a>.</p>

</div>
</div>
</div><!-- contents -->
</div><!-- doc-content -->
<div id="page-nav" class="page-nav-panel">
<div id="page-nav-resize-handle"></div>
<div id="page-nav-tree">
<div id="page-nav-contents">
</div><!-- page-nav-contents -->
</div><!-- page-nav-tree -->
</div><!-- page-nav -->
</div><!-- container -->
<!-- start footer part -->
<div id="nav-path" class="navpath"><!-- id is needed for treeview function! -->
  <ul>
    <li class="navelem"><a href="namespacesrc.html">src</a></li><li class="navelem"><a href="namespacesrc_1_1reporting.html">reporting</a></li><li class="navelem"><a href="namespacesrc_1_1reporting_1_1report__generator.html">report_generator</a></li>
    <li class="footer">Generated on <span class="timestamp"></span> for VisualNet Scanner by <a href="https://www.doxygen.org/index.html"><img class="footer" src="doxygen.svg" width="104" height="31" alt="doxygen"/></a> 1.15.0 </li>
  </ul>
</div>
</body>
</html>
