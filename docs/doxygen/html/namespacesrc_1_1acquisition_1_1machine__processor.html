<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "https://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml" lang="en-US">
<head>
<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=11"/>
<meta name="generator" content="Doxygen 1.15.0"/>
<meta name="viewport" content="width=device-width, initial-scale=1"/>
<title>VisualNet Scanner: src.acquisition.machine_processor Namespace Reference</title>
<link href="tabs.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="jquery.js"></script>
<script type="text/javascript" src="dynsections.js"></script>
<script type="text/javascript" src="clipboard.js"></script>
<link href="navtree.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="navtreedata.js"></script>
<script type="text/javascript" src="navtree.js"></script>
<script type="text/javascript" src="cookie.js"></script>
<link href="search/search.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="search/searchdata.js"></script>
<script type="text/javascript" src="search/search.js"></script>
<link href="doxygen.css" rel="stylesheet" type="text/css" />
</head>
<body>
<div id="top"><!-- do not remove this div, it is closed by doxygen! -->
<div id="titlearea">
<table cellspacing="0" cellpadding="0">
 <tbody>
 <tr id="projectrow">
  <td id="projectalign">
   <div id="projectname">VisualNet Scanner<span id="projectnumber">&#160;1.0</span>
   </div>
   <div id="projectbrief">Comprehensive vulnerability scanner for Linux machines with network visualization</div>
  </td>
 </tr>
 </tbody>
</table>
</div>
<!-- end header part -->
<!-- Generated by Doxygen 1.15.0 -->
<script type="text/javascript">
var searchBox = new SearchBox("searchBox", "search/",'.html');
</script>
<script type="text/javascript">
$(function() { codefold.init(); });
</script>
<script type="text/javascript" src="menudata.js"></script>
<script type="text/javascript" src="menu.js"></script>
<script type="text/javascript">
$(function() {
  initMenu('',true,false,'search.php','Search',true);
  $(function() { init_search(); });
});
</script>
<div id="main-nav"></div>
</div><!-- top -->
<div id="side-nav" class="ui-resizable side-nav-resizable">
  <div id="nav-tree">
    <div id="nav-tree-contents">
      <div id="nav-sync" class="sync"></div>
    </div>
  </div>
  <div id="splitbar" style="-moz-user-select:none;" 
       class="ui-resizable-handle">
  </div>
</div>
<script type="text/javascript">
$(function(){initNavTree('namespacesrc_1_1acquisition_1_1machine__processor.html','',''); });
</script>
<div id="container">
<div id="doc-content">
<!-- window showing the filter options -->
<div id="MSearchSelectWindow"
     onmouseover="return searchBox.OnSearchSelectShow()"
     onmouseout="return searchBox.OnSearchSelectHide()"
     onkeydown="return searchBox.OnSearchSelectKey(event)">
</div>

<!-- iframe showing the search results (closed by default) -->
<div id="MSearchResultsWindow">
<div id="MSearchResults">
<div class="SRPage">
<div id="SRIndex">
<div id="SRResults"></div>
<div class="SRStatus" id="Loading">Loading...</div>
<div class="SRStatus" id="Searching">Searching...</div>
<div class="SRStatus" id="NoMatches">No Matches</div>
</div>
</div>
</div>
</div>

<div class="header">
  <div class="headertitle"><div class="title">src.acquisition.machine_processor Namespace Reference</div></div>
</div><!--header-->
<div class="contents">
<table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 id="header-func-members" class="groupheader"><a id="func-members" name="func-members"></a>
Functions</h2></td></tr>
<tr class="memitem:abab8c06e6c29cb53850befcce93c9fec" id="r_abab8c06e6c29cb53850befcce93c9fec"><td class="memItemLeft" align="right" valign="top">&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="#abab8c06e6c29cb53850befcce93c9fec">process_machine_packages</a> (config, machine)</td></tr>
<tr class="memitem:a4cc80079947e0b142c03674e1fc1c308" id="r_a4cc80079947e0b142c03674e1fc1c308"><td class="memItemLeft" align="right" valign="top">&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="#a4cc80079947e0b142c03674e1fc1c308">generate_cpes_for_packages</a> (new_packages, machine, cpe_matcher)</td></tr>
<tr class="memitem:ac8fdb39cb7b61bcc14a054215b4eceae" id="r_ac8fdb39cb7b61bcc14a054215b4eceae"><td class="memItemLeft" align="right" valign="top">&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="#ac8fdb39cb7b61bcc14a054215b4eceae">process_machine_hardware</a> (config, machine)</td></tr>
<tr class="memitem:a5519ae149a75516407ac21ed15cc0a7a" id="r_a5519ae149a75516407ac21ed15cc0a7a"><td class="memItemLeft" align="right" valign="top">&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="#a5519ae149a75516407ac21ed15cc0a7a">generate_cpes_for_hardware</a> (hardware_info, machine, cpe_matcher)</td></tr>
</table><table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 id="header-var-members" class="groupheader"><a id="var-members" name="var-members"></a>
Variables</h2></td></tr>
<tr class="memitem:a0fe28c1cafccf2cee89aec67487f0412" id="r_a0fe28c1cafccf2cee89aec67487f0412"><td class="memItemLeft" align="right" valign="top">&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="#a0fe28c1cafccf2cee89aec67487f0412">logger</a> = logging.getLogger(__name__)</td></tr>
</table>
<a name="details" id="details"></a><h2 id="header-details" class="groupheader">Detailed Description</h2>
<div class="textblock"><pre class="fragment">@file machine_processor.py
@brief Machine-level processing module for package retrieval and CPE generation

This module handles all operations related to processing individual machines,
including:
- Retrieving installed packages from Linux machines via SSH
- Comparing with cached packages to identify new installations
- Generating CPE identifiers for newly installed packages using AI
- Managing CPE cache to avoid redundant generation

@author Aton Moulin
@date 2025-12-24
@version 1.0
</pre> </div><a name="doc-func-members" id="doc-func-members"></a><h2 id="header-doc-func-members" class="groupheader">Function Documentation</h2>
<a id="a5519ae149a75516407ac21ed15cc0a7a" name="a5519ae149a75516407ac21ed15cc0a7a"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a5519ae149a75516407ac21ed15cc0a7a">&#9670;&#160;</a></span>generate_cpes_for_hardware()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">src.acquisition.machine_processor.generate_cpes_for_hardware </td>
          <td>(</td>
          <td class="paramtype"></td>          <td class="paramname"><span class="paramname"><em>hardware_info</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"></td>          <td class="paramname"><span class="paramname"><em>machine</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"></td>          <td class="paramname"><span class="paramname"><em>cpe_matcher</em></span>&#160;)</td>
        </tr>
      </table>
</div><div class="memdoc">
<pre class="fragment">Generate CPE identifiers for hardware/CPU information.

Uses Google GenAI API to map hardware characteristics to CPE identifiers.
Similar to package CPE generation but for hardware components.

@param hardware_info dict Hardware information from lscpu
@param machine str Machine name for logging
@param cpe_matcher module CPE matcher module with ask_for_cpe() function

@return dict Dictionary mapping hardware components to CPE lists
        Example: {'CPU-Intel-Xeon': ['cpe:2.3:h:intel:xeon:...']}

@details
Hardware vulnerabilities are typically microarchitecture-related:
- Spectre family (register file/predictor/cache) 
- Meltdown (TLB)
- Side-channel attacks
- Bus locking issues

The CPE matcher identifies the vendor and model to generate appropriate CPEs.
</pre> 
<p class="definition">Definition at line <a class="el" href="machine__processor_8py_source.html#l00213">213</a> of file <a class="el" href="machine__processor_8py_source.html">machine_processor.py</a>.</p>

</div>
</div>
<a id="a4cc80079947e0b142c03674e1fc1c308" name="a4cc80079947e0b142c03674e1fc1c308"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a4cc80079947e0b142c03674e1fc1c308">&#9670;&#160;</a></span>generate_cpes_for_packages()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">src.acquisition.machine_processor.generate_cpes_for_packages </td>
          <td>(</td>
          <td class="paramtype"></td>          <td class="paramname"><span class="paramname"><em>new_packages</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"></td>          <td class="paramname"><span class="paramname"><em>machine</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"></td>          <td class="paramname"><span class="paramname"><em>cpe_matcher</em></span>&#160;)</td>
        </tr>
      </table>
</div><div class="memdoc">
<pre class="fragment">Generate Common Platform Enumeration (CPE) identifiers for packages.

Uses Google GenAI API to intelligently map package names to CPE identifiers.
Retrieves cached CPEs for previously processed packages to avoid redundant
AI model calls.

@param new_packages list Package names to generate CPEs for
@param machine str Machine name for logging and file operations
@param cpe_matcher module CPE matcher module with ask_for_cpe() function

@return dict Dictionary mapping package names to their CPE lists
        Format: {package_name: [cpe_string_1, cpe_string_2, ...]}

@details
- Filters packages to only process those without cached CPEs
- Calls AI model once with all packages (batch operation)
- Parses AI response to extract valid CPE strings
- Pairs CPEs 1:1 with packages
- Caches generated CPEs for future runs
- Retrieves previously cached CPEs for packages that have them
</pre> 
<p class="definition">Definition at line <a class="el" href="machine__processor_8py_source.html#l00085">85</a> of file <a class="el" href="machine__processor_8py_source.html">machine_processor.py</a>.</p>

</div>
</div>
<a id="ac8fdb39cb7b61bcc14a054215b4eceae" name="ac8fdb39cb7b61bcc14a054215b4eceae"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ac8fdb39cb7b61bcc14a054215b4eceae">&#9670;&#160;</a></span>process_machine_hardware()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">src.acquisition.machine_processor.process_machine_hardware </td>
          <td>(</td>
          <td class="paramtype"></td>          <td class="paramname"><span class="paramname"><em>config</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"></td>          <td class="paramname"><span class="paramname"><em>machine</em></span>&#160;)</td>
        </tr>
      </table>
</div><div class="memdoc">
<pre class="fragment">Retrieve and process hardware information for a machine.

Connects to a machine using lscpu and extracts CPU/hardware details
for CPE generation and vulnerability matching.

@param config ConfigParser object containing machine configuration
@param machine str Machine name from inventory

@return dict Hardware information dictionary with keys:
             - vendor_id: CPU vendor (Intel, AMD, etc.)
             - model_name: CPU model description  
             - family: CPU family identifier
             - model: CPU model number
             - stepping: CPU stepping number
             - flags: CPU flags (spectre, meltdown mitigation, etc.)
             - cores: Number of CPU cores
             - threads: Threads per core
             - raw_output: Complete lscpu output

@details
Used to detect vulnerabilities like:
- Spectre (CVE-2017-5753, CVE-2017-5715)
- Meltdown (CVE-2017-5754)
- CPU errata and microcode issues
</pre> 
<p class="definition">Definition at line <a class="el" href="machine__processor_8py_source.html#l00169">169</a> of file <a class="el" href="machine__processor_8py_source.html">machine_processor.py</a>.</p>

</div>
</div>
<a id="abab8c06e6c29cb53850befcce93c9fec" name="abab8c06e6c29cb53850befcce93c9fec"></a>
<h2 class="memtitle"><span class="permalink"><a href="#abab8c06e6c29cb53850befcce93c9fec">&#9670;&#160;</a></span>process_machine_packages()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">src.acquisition.machine_processor.process_machine_packages </td>
          <td>(</td>
          <td class="paramtype"></td>          <td class="paramname"><span class="paramname"><em>config</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"></td>          <td class="paramname"><span class="paramname"><em>machine</em></span>&#160;)</td>
        </tr>
      </table>
</div><div class="memdoc">
<pre class="fragment">Retrieve and process installed packages for a machine.

Connects to a machine, retrieves all installed packages, compares them
with previously cached packages, and identifies newly installed packages.

@param config ConfigParser object containing machine configuration
@param machine str Machine name from inventory

@return tuple (installed_packages, new_packages)
        installed_packages list: All currently installed packages
        new_packages list: Packages not in the cache
        Returns ([], []) if machine type is not supported

@details
- Creates machine directory if it doesn't exist
- Uses pkg_finder.get_installed_packages_linux() for SSH operations
- Compares with cached data using pkg_finder.get_new_packages()
- Updates package cache JSON file
</pre> 
<p class="definition">Definition at line <a class="el" href="machine__processor_8py_source.html#l00028">28</a> of file <a class="el" href="machine__processor_8py_source.html">machine_processor.py</a>.</p>

</div>
</div>
<a name="doc-var-members" id="doc-var-members"></a><h2 id="header-doc-var-members" class="groupheader">Variable Documentation</h2>
<a id="a0fe28c1cafccf2cee89aec67487f0412" name="a0fe28c1cafccf2cee89aec67487f0412"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a0fe28c1cafccf2cee89aec67487f0412">&#9670;&#160;</a></span>logger</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">src.acquisition.machine_processor.logger = logging.getLogger(__name__)</td>
        </tr>
      </table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="machine__processor_8py_source.html#l00025">25</a> of file <a class="el" href="machine__processor_8py_source.html">machine_processor.py</a>.</p>

</div>
</div>
</div><!-- contents -->
</div><!-- doc-content -->
<div id="page-nav" class="page-nav-panel">
<div id="page-nav-resize-handle"></div>
<div id="page-nav-tree">
<div id="page-nav-contents">
</div><!-- page-nav-contents -->
</div><!-- page-nav-tree -->
</div><!-- page-nav -->
</div><!-- container -->
<!-- start footer part -->
<div id="nav-path" class="navpath"><!-- id is needed for treeview function! -->
  <ul>
    <li class="navelem"><a href="namespacesrc.html">src</a></li><li class="navelem"><a href="namespacesrc_1_1acquisition.html">acquisition</a></li><li class="navelem"><a href="namespacesrc_1_1acquisition_1_1machine__processor.html">machine_processor</a></li>
    <li class="footer">Generated on <span class="timestamp"></span> for VisualNet Scanner by <a href="https://www.doxygen.org/index.html"><img class="footer" src="doxygen.svg" width="104" height="31" alt="doxygen"/></a> 1.15.0 </li>
  </ul>
</div>
</body>
</html>
