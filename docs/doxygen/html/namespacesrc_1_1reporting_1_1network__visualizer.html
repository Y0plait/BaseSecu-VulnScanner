<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "https://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml" lang="en-US">
<head>
<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=11"/>
<meta name="generator" content="Doxygen 1.15.0"/>
<meta name="viewport" content="width=device-width, initial-scale=1"/>
<title>VisualNet Scanner: src.reporting.network_visualizer Namespace Reference</title>
<link href="tabs.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="jquery.js"></script>
<script type="text/javascript" src="dynsections.js"></script>
<script type="text/javascript" src="clipboard.js"></script>
<link href="navtree.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="navtreedata.js"></script>
<script type="text/javascript" src="navtree.js"></script>
<script type="text/javascript" src="cookie.js"></script>
<link href="search/search.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="search/searchdata.js"></script>
<script type="text/javascript" src="search/search.js"></script>
<link href="doxygen.css" rel="stylesheet" type="text/css" />
</head>
<body>
<div id="top"><!-- do not remove this div, it is closed by doxygen! -->
<div id="titlearea">
<table cellspacing="0" cellpadding="0">
 <tbody>
 <tr id="projectrow">
  <td id="projectalign">
   <div id="projectname">VisualNet Scanner<span id="projectnumber">&#160;1.0</span>
   </div>
   <div id="projectbrief">Comprehensive vulnerability scanner for Linux machines with network visualization</div>
  </td>
 </tr>
 </tbody>
</table>
</div>
<!-- end header part -->
<!-- Generated by Doxygen 1.15.0 -->
<script type="text/javascript">
var searchBox = new SearchBox("searchBox", "search/",'.html');
</script>
<script type="text/javascript">
$(function() { codefold.init(); });
</script>
<script type="text/javascript" src="menudata.js"></script>
<script type="text/javascript" src="menu.js"></script>
<script type="text/javascript">
$(function() {
  initMenu('',true,false,'search.php','Search',true);
  $(function() { init_search(); });
});
</script>
<div id="main-nav"></div>
</div><!-- top -->
<div id="side-nav" class="ui-resizable side-nav-resizable">
  <div id="nav-tree">
    <div id="nav-tree-contents">
      <div id="nav-sync" class="sync"></div>
    </div>
  </div>
  <div id="splitbar" style="-moz-user-select:none;" 
       class="ui-resizable-handle">
  </div>
</div>
<script type="text/javascript">
$(function(){initNavTree('namespacesrc_1_1reporting_1_1network__visualizer.html','',''); });
</script>
<div id="container">
<div id="doc-content">
<!-- window showing the filter options -->
<div id="MSearchSelectWindow"
     onmouseover="return searchBox.OnSearchSelectShow()"
     onmouseout="return searchBox.OnSearchSelectHide()"
     onkeydown="return searchBox.OnSearchSelectKey(event)">
</div>

<!-- iframe showing the search results (closed by default) -->
<div id="MSearchResultsWindow">
<div id="MSearchResults">
<div class="SRPage">
<div id="SRIndex">
<div id="SRResults"></div>
<div class="SRStatus" id="Loading">Loading...</div>
<div class="SRStatus" id="Searching">Searching...</div>
<div class="SRStatus" id="NoMatches">No Matches</div>
</div>
</div>
</div>
</div>

<div class="header">
  <div class="headertitle"><div class="title">src.reporting.network_visualizer Namespace Reference</div></div>
</div><!--header-->
<div class="contents">
<table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 id="header-func-members" class="groupheader"><a id="func-members" name="func-members"></a>
Functions</h2></td></tr>
<tr class="memitem:ad5d205846b79d6b7e7e687dc239b10cf" id="r_ad5d205846b79d6b7e7e687dc239b10cf"><td class="memItemLeft" align="right" valign="top">&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="#ad5d205846b79d6b7e7e687dc239b10cf">create_fallback_network_svg</a> (host_address, machine_name)</td></tr>
<tr class="memitem:a657643e1c21c50038e8802b2bfcc9006" id="r_a657643e1c21c50038e8802b2bfcc9006"><td class="memItemLeft" align="right" valign="top">&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="#a657643e1c21c50038e8802b2bfcc9006">generate_network_svg_for_host</a> (host_address, machine_name)</td></tr>
<tr class="memitem:ae22c3d0add4209d4a44d8c426f090ca7" id="r_ae22c3d0add4209d4a44d8c426f090ca7"><td class="memItemLeft" align="right" valign="top">&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="#ae22c3d0add4209d4a44d8c426f090ca7">svg_to_base64</a> (svg_file_path)</td></tr>
<tr class="memitem:a48260ec72ab1bdf92e4cd14d34740553" id="r_a48260ec72ab1bdf92e4cd14d34740553"><td class="memItemLeft" align="right" valign="top">&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="#a48260ec72ab1bdf92e4cd14d34740553">read_svg_content</a> (svg_file_path)</td></tr>
<tr class="memitem:ac169df11696c7e8d31fc6a411b76486b" id="r_ac169df11696c7e8d31fc6a411b76486b"><td class="memItemLeft" align="right" valign="top">&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="#ac169df11696c7e8d31fc6a411b76486b">generate_network_visualizations</a> (machines_config)</td></tr>
</table><table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 id="header-var-members" class="groupheader"><a id="var-members" name="var-members"></a>
Variables</h2></td></tr>
<tr class="memitem:a96b873cbd337c8744107bd56c7c08939" id="r_a96b873cbd337c8744107bd56c7c08939"><td class="memItemLeft" align="right" valign="top">&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="#a96b873cbd337c8744107bd56c7c08939">logger</a> = logging.getLogger(__name__)</td></tr>
</table>
<a name="details" id="details"></a><h2 id="header-details" class="groupheader">Detailed Description</h2>
<div class="textblock"><pre class="fragment">@file network_visualizer.py
@brief Network visualization using nmap-formatter and visualnet-scanner.sh

Generates SVG network topology diagrams for each machine's network segment
using the visualnet-scanner.sh script and nmap-formatter.

@author Anton Moulin
@date 2025-12-24
@version 1.0

@details
Features:
- Generates network topology SVGs for each scanned host's network
- Integrates with existing visualnet-scanner.sh script
- Caches SVG files for report inclusion
- Converts SVG to base64 for embedding in HTML reports
- Handles nmap-formatter execution and error cases
</pre> </div><a name="doc-func-members" id="doc-func-members"></a><h2 id="header-doc-func-members" class="groupheader">Function Documentation</h2>
<a id="ad5d205846b79d6b7e7e687dc239b10cf" name="ad5d205846b79d6b7e7e687dc239b10cf"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ad5d205846b79d6b7e7e687dc239b10cf">&#9670;&#160;</a></span>create_fallback_network_svg()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">src.reporting.network_visualizer.create_fallback_network_svg </td>
          <td>(</td>
          <td class="paramtype"></td>          <td class="paramname"><span class="paramname"><em>host_address</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"></td>          <td class="paramname"><span class="paramname"><em>machine_name</em></span>&#160;)</td>
        </tr>
      </table>
</div><div class="memdoc">
<pre class="fragment">Create a fallback SVG showing network information when real scan is unavailable.

@param host_address str IP address or hostname
@param machine_name str Machine name

@return str SVG content as string

@details
Generates a simple informational SVG showing the scanned host when
actual network scan fails due to missing dependencies (nmap, nmap-formatter, graphviz)
</pre> 
<p class="definition">Definition at line <a class="el" href="network__visualizer_8py_source.html#l00032">32</a> of file <a class="el" href="network__visualizer_8py_source.html">network_visualizer.py</a>.</p>

</div>
</div>
<a id="a657643e1c21c50038e8802b2bfcc9006" name="a657643e1c21c50038e8802b2bfcc9006"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a657643e1c21c50038e8802b2bfcc9006">&#9670;&#160;</a></span>generate_network_svg_for_host()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">src.reporting.network_visualizer.generate_network_svg_for_host </td>
          <td>(</td>
          <td class="paramtype"></td>          <td class="paramname"><span class="paramname"><em>host_address</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"></td>          <td class="paramname"><span class="paramname"><em>machine_name</em></span>&#160;)</td>
        </tr>
      </table>
</div><div class="memdoc">
<pre class="fragment">Generate SVG network topology diagram for a specific host using visualnet-scanner.

Executes the visualnet-scanner.sh script to perform an Nmap scan on the target
host and generate an SVG visualization of the network topology. Results are
cached for future report generation.

@param host_address str IP address or hostname to scan (e.g., "192.168.10.66")
@param machine_name str Machine identifier for caching (e.g., "srv01")

@return str Path to generated SVG file (cache/machines/{machine}/network_topology.svg)
        or None if generation failed

@details
**Execution Flow:**

1. Verify visualnet-scanner.sh exists and is executable
2. Call: ./visualnet-scanner.sh {host_address} network_topology.svg
3. Script internally:
   - Executes nmap scan (-T4 -F mode for speed)
   - Converts Nmap XML to Graphviz DOT format via nmap-formatter
   - Generates SVG using dot -Tsvg
4. Capture SVG output from stdout
5. Save to cache/machines/{machine}/network_topology.svg

**Output Location:**

- File: cache/machines/{machine_name}/network_topology.svg
- Permissions: User readable
- Size: Typically 5-50KB depending on network size

**External Dependencies:**

- visualnet-scanner.sh: Main orchestration script (must be in project root)
- nmap: Network scanning tool (system package)
- nmap-formatter: Custom binary (project root)
- graphviz (dot): SVG generation (system package)

**Error Handling:**

- Missing script: Logs warning, returns None
- Non-executable script: Logs warning, returns None
- Nmap timeout: Falls back to informational SVG
- Format conversion failure: Falls back to informational SVG
- Empty output: Creates fallback SVG with machine info

**Timeouts:**

- Default: 5 minutes (300 seconds)
- Covers: Nmap scan + format conversion + SVG generation

@note
- Logs execution details to logger for audit trail
- Uses subprocess.run() with capture_output=True, text=True
- Suppresses stderr to avoid log pollution
- Creates fallback SVG if primary scanning fails
</pre> 
<p class="definition">Definition at line <a class="el" href="network__visualizer_8py_source.html#l00080">80</a> of file <a class="el" href="network__visualizer_8py_source.html">network_visualizer.py</a>.</p>

</div>
</div>
<a id="ac169df11696c7e8d31fc6a411b76486b" name="ac169df11696c7e8d31fc6a411b76486b"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ac169df11696c7e8d31fc6a411b76486b">&#9670;&#160;</a></span>generate_network_visualizations()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">src.reporting.network_visualizer.generate_network_visualizations </td>
          <td>(</td>
          <td class="paramtype"></td>          <td class="paramname"><span class="paramname"><em>machines_config</em></span></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">
<pre class="fragment">Generate network visualizations for all machines in the inventory.

@param machines_config dict Machine configuration from inventory
                             {machine_name: {'host': ip, 'user': user, ...}}

@return dict Network visualization data
             {machine_name: {
                 'svg_path': 'path/to/file.svg',
                 'svg_content': '&lt;svg&gt;...&lt;/svg&gt;',
                 'generated': True/False
             }}

@details
Iterates through all Linux machines in the inventory and generates
network topology SVGs for their respective networks.
Returns both file paths and inline SVG content for flexible inclusion in reports.
</pre> 
<p class="definition">Definition at line <a class="el" href="network__visualizer_8py_source.html#l00297">297</a> of file <a class="el" href="network__visualizer_8py_source.html">network_visualizer.py</a>.</p>

</div>
</div>
<a id="a48260ec72ab1bdf92e4cd14d34740553" name="a48260ec72ab1bdf92e4cd14d34740553"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a48260ec72ab1bdf92e4cd14d34740553">&#9670;&#160;</a></span>read_svg_content()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">src.reporting.network_visualizer.read_svg_content </td>
          <td>(</td>
          <td class="paramtype"></td>          <td class="paramname"><span class="paramname"><em>svg_file_path</em></span></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">
<pre class="fragment">Read SVG file content as string for direct inclusion in HTML.

@param svg_file_path str Path to SVG file

@return str SVG content, or None if file not found/readable

@details
Reads the SVG file as text and returns the content.
This allows inline SVG embedding without data URI encoding.
</pre> 
<p class="definition">Definition at line <a class="el" href="network__visualizer_8py_source.html#l00269">269</a> of file <a class="el" href="network__visualizer_8py_source.html">network_visualizer.py</a>.</p>

</div>
</div>
<a id="ae22c3d0add4209d4a44d8c426f090ca7" name="ae22c3d0add4209d4a44d8c426f090ca7"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ae22c3d0add4209d4a44d8c426f090ca7">&#9670;&#160;</a></span>svg_to_base64()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">src.reporting.network_visualizer.svg_to_base64 </td>
          <td>(</td>
          <td class="paramtype"></td>          <td class="paramname"><span class="paramname"><em>svg_file_path</em></span></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">
<pre class="fragment">Convert SVG file to base64 encoding for embedding in HTML.

@param svg_file_path str Path to SVG file

@return str Base64 encoded SVG content, or None if file not found/readable

@details
Converts SVG file to base64 for direct embedding in HTML via data URI.
This allows the SVG to be included without external file dependencies.
</pre> 
<p class="definition">Definition at line <a class="el" href="network__visualizer_8py_source.html#l00239">239</a> of file <a class="el" href="network__visualizer_8py_source.html">network_visualizer.py</a>.</p>

</div>
</div>
<a name="doc-var-members" id="doc-var-members"></a><h2 id="header-doc-var-members" class="groupheader">Variable Documentation</h2>
<a id="a96b873cbd337c8744107bd56c7c08939" name="a96b873cbd337c8744107bd56c7c08939"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a96b873cbd337c8744107bd56c7c08939">&#9670;&#160;</a></span>logger</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">src.reporting.network_visualizer.logger = logging.getLogger(__name__)</td>
        </tr>
      </table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="network__visualizer_8py_source.html#l00029">29</a> of file <a class="el" href="network__visualizer_8py_source.html">network_visualizer.py</a>.</p>

</div>
</div>
</div><!-- contents -->
</div><!-- doc-content -->
<div id="page-nav" class="page-nav-panel">
<div id="page-nav-resize-handle"></div>
<div id="page-nav-tree">
<div id="page-nav-contents">
</div><!-- page-nav-contents -->
</div><!-- page-nav-tree -->
</div><!-- page-nav -->
</div><!-- container -->
<!-- start footer part -->
<div id="nav-path" class="navpath"><!-- id is needed for treeview function! -->
  <ul>
    <li class="navelem"><a href="namespacesrc.html">src</a></li><li class="navelem"><a href="namespacesrc_1_1reporting.html">reporting</a></li><li class="navelem"><a href="namespacesrc_1_1reporting_1_1network__visualizer.html">network_visualizer</a></li>
    <li class="footer">Generated on <span class="timestamp"></span> for VisualNet Scanner by <a href="https://www.doxygen.org/index.html"><img class="footer" src="doxygen.svg" width="104" height="31" alt="doxygen"/></a> 1.15.0 </li>
  </ul>
</div>
</body>
</html>
